% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/auc_weighted.R
\name{calculate_weighted_elevations}
\alias{calculate_weighted_elevations}
\title{Calculate Probability-Weighted Elevations for All Points}
\usage{
calculate_weighted_elevations(data)
}
\arguments{
\item{data}{Dataframe with columns: distance, elevation, sigma_v, point_type}
}
\value{
Dataframe with added columns:
  - elev_weighted: Nominal (probability-weighted) elevation
  - elev_upper: Upper bound (elevation + 1σ, probability-weighted)
  - elev_lower: Lower bound (elevation - 1σ, probability-weighted, >= 0)
}
\description{
Applies probability weighting to points near zero elevation based on their
vertical uncertainty. Points with high confidence of being above zero receive
minimal adjustment, while points with significant uncertainty have their
contribution reduced proportionally.
}
\details{
For measured_zero points (points within 1.96σ_v of zero):
  - Apply probability weighting: ε * Φ(ε / σ_v)
  - Φ is the standard normal cumulative distribution function (pnorm)
  - Upper/lower bounds are also weighted for consistency
  - Lower bound is clamped to >= 0 (cannot have negative area)

For all other points:
  - No weighting applied (elevation is far from zero)
  - Simple bounds: elevation ± sigma_v

Physical Interpretation Examples:
  - ε = +0.10m, σ_v = 0.05m → z = 2.0 → Φ(2.0) = 0.977
    97.7% confidence point is above zero, weighted = 0.098m (2% reduction)
  - ε = +0.05m, σ_v = 0.10m → z = 0.5 → Φ(0.5) = 0.691
    69.1% confidence point is above zero, weighted = 0.035m (30% reduction)
  - ε = -0.05m, σ_v = 0.10m → z = -0.5 → Φ(-0.5) = 0.309
    30.9% chance point is above zero, weighted = -0.015m (contribution reduced)
}
